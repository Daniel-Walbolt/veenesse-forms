var A=(a,t,e)=>new Promise((i,o)=>{var r=n=>{try{V(e.next(n))}catch(l){o(l)}},d=n=>{try{V(e.throw(n))}catch(l){o(l)}},V=n=>n.done?i(n.value):Promise.resolve(n.value).then(r,d);V((e=e.apply(a,t)).next())});function O(a){let t=0,e;return(...i)=>{var r;let o=++t;return e=(r=e==null?void 0:e.then(()=>{if(t==o)return e=a(...i).then(d=>(e=void 0,d)),e}))!=null?r:a(...i).then(d=>(e=void 0,d)),e}}function z(a,t){let e=0,i;return(...o)=>new Promise(r=>{let d=++e,V=new Date().getTime();i!=null||(i=V-t);let n=V-i-t;n<0?new Promise(l=>setTimeout(l,-1*n)).then(()=>{i=new Date().getTime(),d==e&&r(a(...o)),r(void 0)}):(i=V,r(a(...o)))})}function L(a,t=e=>e){return a.reduce((e,i)=>{if(i!==void 0){let o=t(i);o!==void 0&&e.push(o)}return e},[])}function C(a){return a.reduce((t,e)=>{if(e!==void 0)if(e instanceof Array)for(let i of e)i!==void 0&&t.push(i);else t.push(e);return t},[])}function aa(){return a=>({isValid:a.value!==void 0&&String(a.value).trim().length>0,errorMessage:"This field is required"})}function ea(a,t){return e=>A(this,null,function*(){return(yield a(e))===!1?{isValid:!0}:t})}function ta(a){return t=>{var i;let e=String((i=t.value)!=null?i:"");return{isValid:e.length>=a,errorMessage:`Too short (${e.length} / ${a})`}}}function ia(a){return t=>{var e,i,o,r;return{isValid:((i=(e=t.value)==null?void 0:e.length)!=null?i:0)<=a,errorMessage:`Too long (${(r=(o=t.value)==null?void 0:o.length)!=null?r:0} / ${a})`}}}function na(a){return t=>({isValid:t.value!==void 0&&t.value>=a,errorMessage:`Must be atleast ${a}`})}function ra(){return a=>({isValid:a.value?RegExp(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/).test(a.value):!1,errorMessage:"Invalid email format"})}import{ref as q,computed as h,watch as W,reactive as S}from"vue";import{computed as E}from"vue";import{computed as g,reactive as N,ref as b}from"vue";function D(){return`${Date.now()}-${Math.floor(Math.random()*1e3)}`}function K(a,t,e){let i=[],o=r=>`${t?"reactive":"lazy"}-${D()}`;e!=null&&(o=r=>`${e}-${r}`);for(let[r,d]of a.entries())i.push({validatorId:o(r),validator:d,optimized:!1,isReactive:t,previouslyReturnedValidators:!1,previouslySpawnedValidators:{},spawnedValidators:{}});return i}function T(a,t,e=[]){var l,P,u,s;let i=N({isValid:g(()=>{var y,c;let f=(y=n.isLazyValid.value)!=null?y:!1,v=(c=n.isReactiveValid.value)!=null?c:!1;return f&&v}),isValidating:g(()=>n.isValidatingReactive.value||n.isValidatingLazy.value),isErrored:g(()=>i.resultsArray.some(f=>f.isValid===!1)),errorMessages:g(()=>C(L(i.resultsArray,f=>f.isValid?void 0:f.errorMessage))),results:g(()=>n.namedValidationResults.value),resultsArray:g(()=>n.validationResults.value),arrayState:g(()=>{if(Array.isArray(a.value)===!1||n.elementValidation===void 0)return[];console.time("Array state");let f=a.value,v=n.elementValidation,y=n.arrayConfigMap,c=[],p={},m,x=[];for(let R=0;R<f.length;R++){if(f[R]!==void 0&&typeof f[R]=="object"?(f[R].$ffId===void 0&&Object.defineProperty(f[R],"$ffId",{value:`${n.id}-${n.elementId++}`,writable:!1,configurable:!1,enumerable:!1}),m=f[R].$ffId):f[R]!==void 0&&(y[R]===void 0?m=R:console.log(y[R].validationConfigs[0].property.value)),x.push(m),y[m]){c.push(y[m].validationState),p[m]=y[m];continue}let w=g(()=>f[R]);if(G(v)){let I=T(w,v,n.arrayParents.concat(w));y[m]={validationConfigs:[I],validationState:I.validationState}}else{let M=f[R],k=$(M,v,n.arrayParents.concat(w));y[m]={validationConfigs:k.validationConfigs,validationState:k.state}}c.push(y[m].validationState),p[m]=y[m]}return n.arrayConfigMap=p,console.timeEnd("Array state"),c})}),o=!(((P=(l=t.$lazy)==null?void 0:l.length)!=null?P:-1)>0),r=!(((s=(u=t.$reactive)==null?void 0:u.length)!=null?s:-1)>0),d=t.$reactive?K(t.$reactive,!0):[],V=t.$lazy?K(t.$lazy,!1):[],n={id:D(),validationIterationId:0,isReactiveValid:b(r),isValidatingReactive:b(!1),reactiveProcessedValidators:d,isLazyValid:b(o),isValidatingLazy:b(!1),lazyProcessedValidators:V,property:a,validation:t,validationState:i,validationResults:b([]),namedValidationResults:b({}),arrayConfigMap:{},elementId:0,elementValidation:t.$each,arrayParents:N(e)};return n}function $(a,t,e=[]){let i=[],o={};t!==void 0&&r(a,t);function r(d,V){for(let n in V){let l=g(()=>d[n]);if(G(V[n])){let P=V[n],u=T(l,P,e);i.push(u),o[n]=u.validationState}else{let P={},u=V[n];o[n]=P,r(l,u)}}}return{validationConfigs:i,state:o}}function G(a){return(a==null?void 0:a.$reactive)!==void 0||(a==null?void 0:a.$lazy)!==void 0||(a==null?void 0:a.$each)!==void 0}var j=500;function J(a,t,e,i,o){return A(this,null,function*(){let r=!0,d=(l,P,u)=>{if(i!==l.validationIterationId)return;u.isValid===!1&&(r=!1),u.id=P.validatorId;let s=l.validationResults.value.find(f=>f.id===u.id);s!==void 0?(Object.assign(s,u),u.name!==void 0&&l.namedValidationResults[u.name]!==void 0&&Object.assign(l.namedValidationResults.value[u.name],u)):(l.validationResults.value.push(u),u.name!==void 0&&(l.namedValidationResults.value[u.name]=u))},{asyncPromises:V,validatorsWhichPreviouslyReturnedValidators:n}=Q(a,t,e,i,o,d,!0,1);if(yield Promise.all(V),i===a.validationIterationId){for(let l of n)for(let P of Object.keys(l.previouslySpawnedValidators))if(l.spawnedValidators[P]==null){let u=a.validationResults.value.findIndex(s=>s.id===P);u!==-1&&a.validationResults.value.splice(u)}}return r})}function Q(a,t,e,i,o,r,d,V){let n=a.property.value,l=[],P=[],u=[];for(let s of o){let f=!1;s.previouslyReturnedValidators&&(s.previouslySpawnedValidators=s.spawnedValidators,s.spawnedValidators={},f=!0),s.previouslyReturnedValidators=!1;let v;if(s.computedValidator===void 0){let y={value:n,parent:t,args:e,arrayParents:a.arrayParents.map(c=>c.value)};v=s.validator(y)}else v=s.computedValidator.value;if(v instanceof Promise){let y=Date.now();l.push(v.then(c=>A(this,null,function*(){if(c===void 0){f&&u.push(s);return}let p=Date.now()-y;if(d&&p>j&&s.optimized===!1&&(s.optimized=!0,p<2*j?s.validator=z(s.validator,j):s.validator=O(s.validator)),Array.isArray(c)){let{asyncPromises:m,syncResults:x}=B(a,t,e,i,r,s,c,V);P.push(...x),yield Promise.all(m);return}else f&&u.push(s);r(a,s,c)})))}else if(Array.isArray(v)){let{asyncPromises:y,syncResults:c}=B(a,t,e,i,r,s,v,V);l.push(...y),P.push(...c)}else if(f&&u.push(s),v!==void 0){if(d&&s.optimized===!1){let y=s.validator;s.computedValidator=E(()=>{let c={value:a.property.value,parent:t,args:e,arrayParents:a.arrayParents.map(p=>p.value)};return y(c)}),s.optimized=!0,s.validator=()=>s.computedValidator.value}P.push(v),r(a,s,v)}}return{asyncPromises:l,syncResults:P,validatorsWhichPreviouslyReturnedValidators:u}}function B(a,t,e,i,o,r,d,V){let n=K(d,r.isReactive,r.validatorId),l=Q(a,t,e,i,n,o,!1,++V),P={};for(let u of n)P[u.validatorId]=u;return r.spawnedValidators=P,r.previouslyReturnedValidators=!0,l}function U(a,t,e,i){return A(this,null,function*(){a.isValidatingReactive.value=!0;let o=yield J(a,t,e,i,a.reactiveProcessedValidators);return i===a.validationIterationId&&(a.isReactiveValid.value=o,a.isValidatingReactive.value=!1),a.isReactiveValid.value})}function Z(a,t,e,i){return A(this,null,function*(){a.isValidatingLazy.value=!0;let o=a.lazyProcessedValidators,r=yield J(a,t,e,i,o);return i===a.validationIterationId&&(a.isLazyValid.value=r,a.isValidatingLazy.value=!1),a.isLazyValid.value})}function F(a,t,e,i,o){return A(this,null,function*(){let r=[];for(let d of a){let V=++d.validationIterationId;if(i&&d.validation.$reactive!==void 0&&r.push(yield U(d,t.value,e,V)),o&&d.validation.$lazy!==void 0&&r.push(yield Z(d,t.value,e,V)),d.elementValidation!==void 0){let n=[];for(let l in d.arrayConfigMap)n.push(...d.arrayConfigMap[l].validationConfigs);r.push(yield F(n,t,e,i,o))}}return Promise.all(r).then(d=>d.every(V=>V===!0))})}function H(a){var y;(y=a.delayReactiveValidation)!=null||(a.delayReactiveValidation=!0);let{objectToValidate:t,validation:e,delayReactiveValidation:i,args:o}=a,r=q(!1),d=h(()=>n.some(c=>c.validationState.isValidating)),V=h(()=>n.every(p=>p.isReactiveValid.value&&p.isLazyValid.value)),n=[],l=S({}),P=q(JSON.stringify(a.objectToValidate.value)),u=h(()=>P.value!==JSON.stringify(a.objectToValidate.value));if(G(e)){let m=T(t,e);l=S(m.validationState),n=[m]}else{let c=t,p=e,m=$(c.value,p);l=S(m.state),n=m.validationConfigs}W(a.objectToValidate,()=>{i?r.value===!0&&F(n,t,o,!0,!1):F(n,t,o,!0,!1)},{deep:!0});function f(){return A(this,null,function*(){let c=yield F(n,t,o,!0,!0);return r.value=!0,c})}function v(c){P.value=JSON.stringify(c)}return S({hasValidated:r,validate:f,isValidating:d,propertyState:h(()=>l),isValid:V,setReference:v,isDirty:u})}export{O as bufferAsync,ra as isEmailSync,ia as maximumLength,na as minValue,ta as minimumLength,aa as required,z as throttleQueueAsync,H as useValidation,ea as validateIf};
