var S=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var w=Object.prototype.hasOwnProperty;var k=(a,t)=>{for(var e in t)S(a,e,{get:t[e],enumerable:!0})},B=(a,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of M(t))!w.call(a,r)&&r!==e&&S(a,r,{get:()=>t[r],enumerable:!(n=j(t,r))||n.enumerable});return a};var E=a=>B(S({},"__esModule",{value:!0}),a);var A=(a,t,e)=>new Promise((n,r)=>{var d=l=>{try{u(e.next(l))}catch(s){r(s)}},i=l=>{try{u(e.throw(l))}catch(s){r(s)}},u=l=>l.done?n(l.value):Promise.resolve(l.value).then(d,i);u((e=e.apply(a,t)).next())});var W={};k(W,{bufferAsync:()=>z,isEmailSync:()=>U,maximumLength:()=>J,minValue:()=>Q,minimumLength:()=>D,required:()=>L,throttleQueueAsync:()=>T,useValidation:()=>O,validateIf:()=>N});module.exports=E(W);function z(a){let t=0,e;return(...n)=>{var d;let r=++t;return e=(d=e==null?void 0:e.then(()=>{if(t==r)return e=a(...n).then(i=>(e=void 0,i)),e}))!=null?d:a(...n).then(i=>(e=void 0,i)),e}}function T(a,t){let e=0,n;return(...r)=>new Promise(d=>{let i=++e,u=new Date().getTime();n!=null||(n=u-t);let l=u-n-t;l<0?new Promise(s=>setTimeout(s,-1*l)).then(()=>{n=new Date().getTime(),i==e&&d(a(...r)),d(void 0)}):(n=u,d(a(...r)))})}function b(a,t=e=>e){return a.reduce((e,n)=>{if(n!=null){let r=t(n);r!=null&&e.push(r)}return e},[])}function F(a){return a.reduce((t,e)=>{if(e!=null)if(e instanceof Array)for(let n of e)n!=null&&t.push(n);else t.push(e);return t},[])}function L(){return a=>({isValid:a.value!=null&&String(a.value).trim().length>0,errorMessage:"This field is required"})}function N(a,t){return e=>A(this,null,function*(){if(a(e.parent,e.args)==!1)return{isValid:!0};let n=[],r=[];for(let l of t){let s=l(e);s instanceof Promise?n.push(s):r.push(s)}let d=yield Promise.all(n);r.push(...b(d));let i=r.filter(l=>!l.isValid).map(l=>l.errorMessage),u=F(i);return{isValid:r.every(l=>l.isValid==!0),errorMessage:u}})}function D(a){return t=>{var n;let e=String((n=t.value)!=null?n:"");return{isValid:e.length>=a,errorMessage:`Too short (${e.length} / ${a})`}}}function J(a){return t=>{var e,n,r,d;return{isValid:((n=(e=t.value)==null?void 0:e.length)!=null?n:0)<=a,errorMessage:`Too long (${(d=(r=t.value)==null?void 0:r.length)!=null?d:0} / ${a})`}}}function Q(a){return t=>({isValid:t.value!=null&&t.value>=a,errorMessage:`Must be atleast ${a}`})}function U(){return a=>({isValid:a.value?RegExp(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/).test(a.value):!1,errorMessage:"Invalid email format"})}var c=require("vue");var Z=(0,c.ref)(0);function O(a){var m;(m=a.delayReactiveValidation)!=null||(a.delayReactiveValidation=!0);let{objectToValidate:t,validation:e,delayReactiveValidation:n,args:r}=a,d=(0,c.ref)(!1),i=(0,c.computed)(()=>l.some(P=>P.validationState.isValidating)),u=(0,c.computed)(()=>l.every(g=>g.reactiveIsValid.value&&g.lazyIsValid.value)),l=[],s=(0,c.reactive)({}),v=(0,c.ref)(JSON.stringify(a.objectToValidate.value)),V=(0,c.computed)(()=>v.value!==JSON.stringify(a.objectToValidate.value));if((e==null?void 0:e.$reactive)!=null||(e==null?void 0:e.$lazy)!=null||(e==null?void 0:e.$each)!=null){let R=I(t,e);s=(0,c.reactive)(R.validationState),l=[R]}else{console.log("Complex object");let P=t,g=e,R=G(P.value,g);s=(0,c.reactive)(R.state),l=R.validationConfigs}(0,c.watch)(a.objectToValidate,()=>{n?d.value==!0&&K(l,t,r,!0,!1):K(l,t,r,!0,!1)},{deep:!0});function y(){return A(this,null,function*(){let P=yield K(l,t,r,!0,!0);return d.value=!0,P})}function f(P){v.value=JSON.stringify(P)}return(0,c.reactive)({hasValidated:d,validate:y,isValidating:i,propertyState:s,isValid:u,setReference:f,isDirty:V})}function q(a,t,e,n){return A(this,null,function*(){var v,V;if(a.validation.$reactive==null)return!0;a.validatingReactive.value=!0;let r=a.validation.$reactive,d=!0;(a.syncValidators.$reactive||a.asyncValidators.$reactive)&&(d=!1,r=((v=a.syncValidators.$reactive)!=null?v:[]).concat((V=a.asyncValidators.$reactive)!=null?V:[]));let i=!0,u=0;function l(o){let y;if(n==a.validationIterationId)for(let f=0;f<o.length;f++)o[f].isValid==!1&&(i=!1),o[f].identifier=`validator-reactive-${a.id}-${u++}`,y=a.reactiveValidationResults.value.find(m=>m.identifier==o[f].identifier),y!=null?Object.assign(y,o[f]):a.reactiveValidationResults.value.push(o[f])}let s=x(a.property.value,t,e,r,l);if(d){let o=[];for(let y of s.asyncValidators)o.push(T(y,1e3));a.asyncValidators.$reactive=o,a.syncValidators.$reactive=s.syncValidators}return l(s.syncResults),yield Promise.all(s.asyncPromises),n==a.validationIterationId&&(a.reactiveIsValid.value=i,a.validatingReactive.value=!1),a.reactiveIsValid.value})}function H(a,t,e,n){return A(this,null,function*(){var v,V;if(a.validation.$lazy==null)return!0;a.validatingLazy.value=!0;let r=!0,d=0,i=!0,u=a.validation.$lazy;(a.syncValidators.$lazy||a.asyncValidators.$lazy)&&(i=!1,u=((v=a.syncValidators.$lazy)!=null?v:[]).concat((V=a.asyncValidators.$lazy)!=null?V:[]));function l(o){let y;if(n==a.validationIterationId)for(let f=0;f<o.length;f++)o[f].isValid==!1&&(r=!1),o[f].identifier=`validator-lazy-${a.id}-${d++}`,y=a.lazyValidationResults.value.find(m=>m.identifier==o[f].identifier),y!=null?Object.assign(y,o[f]):a.lazyValidationResults.value.push(o[f])}let s=x(a.property.value,t,e,u,l);if(i){let o=[];for(let y of s.asyncValidators)o.push(T(y,500));a.asyncValidators.$lazy=o,a.syncValidators.$lazy=s.syncValidators}return l(s.syncResults),yield Promise.all(s.asyncPromises),n==a.validationIterationId&&(a.lazyIsValid.value=r,a.validatingLazy.value=!1),a.lazyIsValid.value})}function K(a,t,e,n,r){return A(this,null,function*(){let d=[];for(let i of a){let u=++i.validationIterationId;if(n&&d.push(q(i,t.value,e,u)),r&&d.push(H(i,t.value,e,u)),i.elementValidation!=null){let l=[];for(let s in i.arrayConfigMap)l.push(...i.arrayConfigMap[s].validationConfigs);d.push(K(l,t,e,n,r))}}return Promise.all(d).then(i=>i.every(u=>u==!0))})}function x(a,t,e,n=[],r){let d=[],i=[],u=[],l=[];for(let s of n){let v=s({value:a,parent:t,args:e});v instanceof Promise?(d.push(v.then(V=>V?r([V]):void 0)),l.push(s)):(i.push(v),u.push(s))}return{syncResults:i,asyncPromises:d,syncValidators:u,asyncValidators:l}}function I(a,t){var u,l,s,v;let e=t.$each!=null,n=(0,c.reactive)({isValid:(0,c.computed)(()=>{var y,f;let V=(y=i.lazyIsValid.value)!=null?y:!1,o=(f=i.reactiveIsValid.value)!=null?f:!1;return V&&o}),isValidating:(0,c.computed)(()=>i.validatingReactive.value||i.validatingLazy.value),isErrored:(0,c.computed)(()=>n.validationResults.some(V=>V.isValid==!1)),errorMessages:(0,c.computed)(()=>F(b(n.validationResults,V=>V.isValid?void 0:V.errorMessage))),validationResults:(0,c.computed)(()=>{var V,o;return((V=i.reactiveValidationResults.value)!=null?V:[]).concat((o=i.lazyValidationResults.value)!=null?o:[])}),arrayState:(0,c.computed)(()=>{if(Array.isArray(a.value)===!1)return;console.time("array state");let V=a.value,o=i.elementValidation,y=i.arrayConfigMap,f=(o==null?void 0:o.$reactive)!=null||(o==null?void 0:o.$lazy)!=null,m,P=[];for(let R=0;R<V.length;R++)if(V[R].$ffId===void 0&&Object.defineProperty(V[R],"$ffId",{value:`${i.id}-${i.elementId++}`,writable:!1,configurable:!1,enumerable:!1}),m=V[R].$ffId,P.push(m),!y[m])if(f){let h=o,$=(0,c.computed)(()=>V[R]),p=I($,h);y[m]={validationConfigs:[p],validationState:p.validationState}}else{let h=V[R],p=G(h,o);y[m]={validationConfigs:p.validationConfigs,validationState:p.state}}let g=[];for(let R=0;R<P.length;R++)g.push(y[P[R]].validationState);return console.timeEnd("array state"),g})}),r=!(((l=(u=t.$lazy)==null?void 0:u.length)!=null?l:-1)>0),d=!(((v=(s=t.$reactive)==null?void 0:s.length)!=null?v:-1)>0),i={id:Z.value++,validationIterationId:0,reactiveIsValid:(0,c.ref)(d),reactiveValidationResults:(0,c.ref)([]),validatingReactive:(0,c.ref)(!1),lazyIsValid:(0,c.ref)(r),lazyValidationResults:(0,c.ref)([]),validatingLazy:(0,c.ref)(!1),validation:t,syncValidators:{},asyncValidators:{},property:a,validationState:n,arrayConfigMap:{},hasElementValidation:e,elementId:0,elementValidation:t.$each};return i}function G(a,t){let e=[],n={};console.log("Performing complex validation setup",t),t!=null&&r(a,t);function r(d,i){for(let u in i){let l=(0,c.computed)(()=>d[u]),s=(i==null?void 0:i.$reactive)!=null||(i==null?void 0:i.$lazy)!=null||(i==null?void 0:i.$each)!=null;if(s){let v=i[u],V=I(l,v);e.push(V),n[u]=V.validationState}else if(s==!1){let v={},V=i[u];n[u]=v,r(l,V)}}}return{validationConfigs:e,state:n}}0&&(module.exports={bufferAsync,isEmailSync,maximumLength,minValue,minimumLength,required,throttleQueueAsync,useValidation,validateIf});
