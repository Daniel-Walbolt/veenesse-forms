var K=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var M=Object.prototype.hasOwnProperty;var k=(a,t)=>{for(var e in t)K(a,e,{get:t[e],enumerable:!0})},B=(a,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of w(t))!M.call(a,l)&&l!==e&&K(a,l,{get:()=>t[l],enumerable:!(i=j(t,l))||i.enumerable});return a};var L=a=>B(K({},"__esModule",{value:!0}),a);var g=(a,t,e)=>new Promise((i,l)=>{var o=d=>{try{c(e.next(d))}catch(u){l(u)}},n=d=>{try{c(e.throw(d))}catch(u){l(u)}},c=d=>d.done?i(d.value):Promise.resolve(d.value).then(o,n);c((e=e.apply(a,t)).next())});var W={};k(W,{bufferAsync:()=>$,isEmailSync:()=>U,maximumLength:()=>J,minValue:()=>Q,minimumLength:()=>D,required:()=>N,throttleQueueAsync:()=>T,useValidation:()=>G,validateIf:()=>E});module.exports=L(W);function $(a){let t=0,e;return(...i)=>{var o;let l=++t;return e=(o=e==null?void 0:e.then(()=>{if(t==l)return e=a(...i).then(n=>(e=void 0,n)),e}))!=null?o:a(...i).then(n=>(e=void 0,n)),e}}function T(a,t){let e=0,i;return(...l)=>new Promise(o=>{let n=++e,c=new Date().getTime();i!=null||(i=c-t);let d=c-i-t;d<0?new Promise(u=>setTimeout(u,-1*d)).then(()=>{i=new Date().getTime(),n==e&&o(a(...l)),o(void 0)}):(i=c,o(a(...l)))})}function z(a,t=e=>e){return a.reduce((e,i)=>{if(i!=null){let l=t(i);l!=null&&e.push(l)}return e},[])}function O(a){return a.reduce((t,e)=>{if(e!=null)if(e instanceof Array)for(let i of e)i!=null&&t.push(i);else t.push(e);return t},[])}function N(){return a=>({isValid:a.value!=null&&String(a.value).trim().length>0,errorMessage:"This field is required"})}function E(a,t){return e=>g(this,null,function*(){return a(e)==!1?{isValid:!0}:t})}function D(a){return t=>{var i;let e=String((i=t.value)!=null?i:"");return{isValid:e.length>=a,errorMessage:`Too short (${e.length} / ${a})`}}}function J(a){return t=>{var e,i,l,o;return{isValid:((i=(e=t.value)==null?void 0:e.length)!=null?i:0)<=a,errorMessage:`Too long (${(o=(l=t.value)==null?void 0:l.length)!=null?o:0} / ${a})`}}}function Q(a){return t=>({isValid:t.value!=null&&t.value>=a,errorMessage:`Must be atleast ${a}`})}function U(){return a=>({isValid:a.value?RegExp(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/).test(a.value):!1,errorMessage:"Invalid email format"})}var V=require("vue");var Z=(0,V.ref)(0);function G(a){var P;(P=a.delayReactiveValidation)!=null||(a.delayReactiveValidation=!0);let{objectToValidate:t,validation:e,delayReactiveValidation:i,args:l}=a,o=(0,V.ref)(!1),n=(0,V.computed)(()=>d.some(m=>m.validationState.isValidating)),c=(0,V.computed)(()=>d.every(A=>A.reactiveIsValid.value&&A.lazyIsValid.value)),d=[],u=(0,V.reactive)({}),y=(0,V.ref)(JSON.stringify(a.objectToValidate.value)),s=(0,V.computed)(()=>y.value!==JSON.stringify(a.objectToValidate.value));if((e==null?void 0:e.$reactive)!=null||(e==null?void 0:e.$lazy)!=null||(e==null?void 0:e.$each)!=null){let R=h(t,e);u=(0,V.reactive)(R.validationState),d=[R]}else{let m=t,A=e,R=x(m.value,A);u=(0,V.reactive)(R.state),d=R.validationConfigs}(0,V.watch)(a.objectToValidate,()=>{i?o.value==!0&&F(d,t,l,!0,!1):F(d,t,l,!0,!1)},{deep:!0});function v(){return g(this,null,function*(){let m=yield F(d,t,l,!0,!0);return o.value=!0,m})}function f(m){y.value=JSON.stringify(m)}return(0,V.reactive)({hasValidated:o,validate:v,isValidating:n,propertyState:u,isValid:c,setReference:f,isDirty:s})}function q(a,t,e,i){return g(this,null,function*(){var y,s;if(a.validation.$reactive==null)return!0;a.validatingReactive.value=!0;let l=!0,o=!0,n=0,c=a.validation.$reactive;(a.syncValidators.$reactive||a.asyncValidators.$reactive)&&(l=!1,c=((y=a.syncValidators.$reactive)!=null?y:[]).concat((s=a.asyncValidators.$reactive)!=null?s:[]));function d(r){let v;if(i==a.validationIterationId)for(let f=0;f<r.length;f++)r[f].isValid==!1&&(o=!1),r[f].identifier=`validator-reactive-${a.id}-${n++}`,v=a.reactiveValidationResults.value.find(P=>P.identifier==r[f].identifier),v!=null?Object.assign(v,r[f]):a.reactiveValidationResults.value.push(r[f])}let u=S(a.property.value,t,e,c,d);if(l){let r=[];for(let v of u.asyncValidators)r.push(T(v,1e3));a.asyncValidators.$reactive=r,a.syncValidators.$reactive=u.syncValidators}return d(u.syncResults),yield Promise.all(u.asyncPromises),i==a.validationIterationId&&(a.reactiveIsValid.value=o,a.validatingReactive.value=!1),a.reactiveIsValid.value})}function H(a,t,e,i){return g(this,null,function*(){var y,s;if(a.validation.$lazy==null)return!0;a.validatingLazy.value=!0;let l=!0,o=0,n=!0,c=a.validation.$lazy;(a.syncValidators.$lazy||a.asyncValidators.$lazy)&&(n=!1,c=((y=a.syncValidators.$lazy)!=null?y:[]).concat((s=a.asyncValidators.$lazy)!=null?s:[]));function d(r){let v;if(i==a.validationIterationId)for(let f=0;f<r.length;f++)r[f].isValid==!1&&(l=!1),r[f].identifier=`validator-lazy-${a.id}-${o++}`,v=a.lazyValidationResults.value.find(P=>P.identifier==r[f].identifier),v!=null?Object.assign(v,r[f]):a.lazyValidationResults.value.push(r[f])}let u=S(a.property.value,t,e,c,d);if(n){let r=[];for(let v of u.asyncValidators)r.push(T(v,500));a.asyncValidators.$lazy=r,a.syncValidators.$lazy=u.syncValidators}return d(u.syncResults),yield Promise.all(u.asyncPromises),i==a.validationIterationId&&(a.lazyIsValid.value=l,a.validatingLazy.value=!1),a.lazyIsValid.value})}function F(a,t,e,i,l){return g(this,null,function*(){let o=[];for(let n of a){let c=++n.validationIterationId;if(i&&o.push(q(n,t.value,e,c)),l&&o.push(H(n,t.value,e,c)),n.elementValidation!=null){let d=[];for(let u in n.arrayConfigMap)d.push(...n.arrayConfigMap[u].validationConfigs);o.push(F(d,t,e,i,l))}}return Promise.all(o).then(n=>n.every(c=>c==!0))})}function S(a,t,e,i=[],l){let o=[],n=[],c=[],d=[];function u(y){let s=y,{syncResults:r,syncValidators:v,asyncPromises:f,asyncValidators:P}=S(a,t,e,s,l);n.push(...r),o.push(...f)}for(let y of i){let s=y({value:a,parent:t,args:e});s instanceof Promise?(o.push(s.then(r=>{if(r!==void 0){if(Array.isArray(r)){u(r);return}return l([r])}})),d.push(y)):Array.isArray(s)?u(s):(s!==void 0&&n.push(s),c.push(y))}return{syncResults:n,asyncPromises:o,syncValidators:c,asyncValidators:d}}function h(a,t){var c,d,u,y;let e=t.$each!=null,i=(0,V.reactive)({isValid:(0,V.computed)(()=>{var v,f;let s=(v=n.lazyIsValid.value)!=null?v:!1,r=(f=n.reactiveIsValid.value)!=null?f:!1;return s&&r}),isValidating:(0,V.computed)(()=>n.validatingReactive.value||n.validatingLazy.value),isErrored:(0,V.computed)(()=>i.validationResults.some(s=>s.isValid==!1)),errorMessages:(0,V.computed)(()=>O(z(i.validationResults,s=>s.isValid?void 0:s.errorMessage))),validationResults:(0,V.computed)(()=>{var s,r;return((s=n.reactiveValidationResults.value)!=null?s:[]).concat((r=n.lazyValidationResults.value)!=null?r:[])}),arrayState:(0,V.computed)(()=>{if(Array.isArray(a.value)===!1)return;console.time("array state");let s=a.value,r=n.elementValidation,v=n.arrayConfigMap,f=(r==null?void 0:r.$reactive)!=null||(r==null?void 0:r.$lazy)!=null,P,m=[];for(let R=0;R<s.length;R++)if(s[R].$ffId===void 0&&Object.defineProperty(s[R],"$ffId",{value:`${n.id}-${n.elementId++}`,writable:!1,configurable:!1,enumerable:!1}),P=s[R].$ffId,m.push(P),!v[P])if(f){let b=r,I=(0,V.computed)(()=>s[R]),p=h(I,b);v[P]={validationConfigs:[p],validationState:p.validationState}}else{let b=s[R],p=x(b,r);v[P]={validationConfigs:p.validationConfigs,validationState:p.state}}let A=[];for(let R=0;R<m.length;R++)A.push(v[m[R]].validationState);return console.timeEnd("array state"),A})}),l=!(((d=(c=t.$lazy)==null?void 0:c.length)!=null?d:-1)>0),o=!(((y=(u=t.$reactive)==null?void 0:u.length)!=null?y:-1)>0),n={id:Z.value++,validationIterationId:0,reactiveIsValid:(0,V.ref)(o),reactiveValidationResults:(0,V.ref)([]),validatingReactive:(0,V.ref)(!1),lazyIsValid:(0,V.ref)(l),lazyValidationResults:(0,V.ref)([]),validatingLazy:(0,V.ref)(!1),validation:t,syncValidators:{},asyncValidators:{},property:a,validationState:i,arrayConfigMap:{},hasElementValidation:e,elementId:0,elementValidation:t.$each};return n}function x(a,t){let e=[],i={};console.log("Performing complex validation setup",t),t!=null&&l(a,t);function l(o,n){var c,d,u;for(let y in n){let s=(0,V.computed)(()=>o[y]),r=((c=n[y])==null?void 0:c.$reactive)!=null||((d=n[y])==null?void 0:d.$lazy)!=null||((u=n[y])==null?void 0:u.$each)!=null;if(r){let v=n[y],f=h(s,v);e.push(f),i[y]=f.validationState}else if(r==!1){let v={},f=n[y];i[y]=v,l(s,f)}}}return{validationConfigs:e,state:i}}0&&(module.exports={bufferAsync,isEmailSync,maximumLength,minValue,minimumLength,required,throttleQueueAsync,useValidation,validateIf});
